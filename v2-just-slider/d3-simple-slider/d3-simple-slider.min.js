// https://github.com/johnwalley/d3-simple-slider v1.9.0 Copyright 2020 John Walley
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-transition"),require("d3-axis"),require("d3-selection"),require("d3-array"),require("d3-scale"),require("d3-dispatch"),require("d3-drag"),require("d3-ease")):"function"==typeof define&&define.amd?define(["exports","d3-transition","d3-axis","d3-selection","d3-array","d3-scale","d3-dispatch","d3-drag","d3-ease"],e):e((t=t||self).d3=t.d3||{},t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3,t.d3)}(this,(function(t,e,a,n,r,l,i,u,s){"use strict";function c(t){return"translate("+t+",0)"}function o(t){return"translate(0,"+t+")"}function d(t,e){e=void 0!==e?e.copy():null;var d=[0],f=[0],g=[0,10],m=100,h=100,p=!0,v="M-5.5,-5.5v10l6,5.5l6,-5.5v-10z",k=null,x=null,y=3,A=null,w=null,b=null,D=null,M=null,q=i.dispatch("onchange","start","end","drag"),z=null,F=null,L=null,P=1===t||4===t?-1:1,V=4===t||2===t?-1:1,O=4===t||2===t?"y":"x",R=4===t||2===t?"x":"y",B=1===t||3===t?c:o,E=1===t||3===t?o:c,T=null;switch(t){case 1:T=a.axisTop;break;case 2:T=a.axisRight;break;case 3:T=a.axisBottom;break;case 4:T=a.axisLeft}var j=null,H=null;function Q(a){z=a.selection?a.selection():a,e||(e=(e=g[0]instanceof Date?l.scaleTime():l.scaleLinear()).domain(g).range(1===t||3===t?[0,m]:[h,0]).clamp(!0)),F=l.scaleLinear().range(e.range()).domain(e.range()).clamp(!0),d=d.map((function(t){return l.scaleLinear().range(g).domain(g).clamp(!0)(t)})),w=w||e.tickFormat(),D=D||w||e.tickFormat(),z.selectAll(".axis").data([null]).enter().append("g").attr("transform",E(7*P)).attr("class","axis");var i=z.selectAll(".slider").data([null]),s=i.enter().append("g").attr("class","slider").attr("cursor",1===t||3===t?"ew-resize":"ns-resize").call(u.drag().on("start",(function(){n.select(this).classed("active",!0);var a=F(3===t||1===t?n.event.x:n.event.y);L=d[0]===g[0]&&d[1]===g[0]?1:d[0]===g[1]&&d[1]===g[1]?0:r.scan(d.map((function(t){return Math.abs(t-_(e.invert(a)))})));var l=d.map((function(t,n){return n===L?_(e.invert(a)):t}));G(l),q.call("start",i,1===l.length?l[0]:l),C(l,!0)})).on("drag",(function(){var e=o(F(3===t||1===t?n.event.x:n.event.y));G(e),q.call("drag",i,1===e.length?e[0]:e),C(e,!0)})).on("end",(function(){n.select(this).classed("active",!1);var e=o(F(3===t||1===t?n.event.x:n.event.y));G(e),q.call("end",i,1===e.length?e[0]:e),C(e,!0),L=null})));s.append("line").attr("class","track").attr(O+"1",e.range()[0]-8*V).attr("stroke","#bbb").attr("stroke-width",6).attr("stroke-linecap","round"),s.append("line").attr("class","track-inset").attr(O+"1",e.range()[0]-8*V).attr("stroke","#eee").attr("stroke-width",4).attr("stroke-linecap","round"),M&&s.append("line").attr("class","track-fill").attr(O+"1",1===d.length?e.range()[0]-8*V:e(d[0])).attr("stroke",M).attr("stroke-width",4).attr("stroke-linecap","round"),s.append("line").attr("class","track-overlay").attr(O+"1",e.range()[0]-8*V).attr("stroke","transparent").attr("stroke-width",40).attr("stroke-linecap","round").merge(i.select(".track-overlay"));var c=s.selectAll(".parameter-value").data(d).enter().append("g").attr("class","parameter-value").attr("transform",(function(t){return B(e(t))})).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle");function o(t){var a=_(e.invert(t));return d.map((function(t,e){return 2===d.length?e===L?0===L?Math.min(a,_(d[1])):Math.max(a,_(d[0])):t:e===L?a:t}))}c.append("path").attr("transform","rotate("+90*(t+1)+")").attr("d",v).attr("class","handle").attr("aria-label","handle").attr("aria-valuemax",g[1]).attr("aria-valuemin",g[0]).attr("aria-valuenow",d).attr("aria-orientation",4===t||2===t?"vertical":"horizontal").attr("focusable","true").attr("tabindex",0).attr("fill","white").attr("stroke","#777").on("keydown",(function(t,e){var a=k||(g[1]-g[0])/100;function r(t){return d.map((function(a,n){return 2===d.length?n===e?0===e?Math.min(t,_(d[1])):Math.max(t,_(d[0])):a:n===e?t:a}))}switch(n.event.key){case"ArrowLeft":case"ArrowDown":Q.value(r(+d[e]-a)),n.event.preventDefault();break;case"PageDown":Q.value(r(+d[e]-2*a)),n.event.preventDefault();break;case"ArrowRight":case"ArrowUp":Q.value(r(+d[e]+a)),n.event.preventDefault();break;case"PageUp":Q.value(r(+d[e]+2*a)),n.event.preventDefault();break;case"Home":Q.value(r(g[0])),n.event.preventDefault();break;case"End":Q.value(r(g[1])),n.event.preventDefault()}})),p&&c.append("text").attr("font-size",10).attr(R,P*(24+y)).attr("dy",1===t?"0em":3===t?".71em":".32em").attr("transform",d.length>1?"translate(0,0)":null).text((function(t,e){return w(d[e])})),a.select(".track").attr(O+"2",e.range()[1]+8*V),a.select(".track-inset").attr(O+"2",e.range()[1]+8*V),M&&a.select(".track-fill").attr(O+"2",1===d.length?e(d[0]):e(d[1])),a.select(".track-overlay").attr(O+"2",e.range()[1]+8*V),a.select(".axis").call(T(e).tickFormat(w).ticks(b).tickValues(x).tickPadding(y)),z.select(".axis").select(".domain").remove(),a.select(".axis").attr("transform",E(7*P)),a.selectAll(".axis text").attr("fill","#aaa").attr(R,P*(17+y)).attr("dy",1===t?"0em":3===t?".71em":".32em").attr("text-anchor",2===t?"start":4===t?"end":"middle"),a.selectAll(".axis line").attr("stroke","#aaa"),a.selectAll(".parameter-value").attr("transform",(function(t){return B(e(t))})),U(),H=z.selectAll(".parameter-value text"),j=z.select(".track-fill")}function U(){if(z&&p){var t=[];if(d.forEach((function(e){var a=[];z.selectAll(".axis .tick").each((function(t){a.push(Math.abs(t-e))})),t.push(r.scan(a))})),z.selectAll(".axis .tick text").attr("opacity",(function(e,a){return~t.indexOf(a)?0:1})),H&&d.length>1){var e,a,n=[],l=[];H.nodes().forEach((function(t,r){e=t.getBoundingClientRect(),a=t.getAttribute("transform").split(/[()]/)[1].split(",")["x"===O?0:1],n[r]=e[O]-parseFloat(a),l[r]=e["x"===O?"width":"height"]})),"x"===O?(a=Math.max(0,(n[0]+l[0]-n[1])/2),H.attr("transform",(function(t,e){return"translate("+(1===e?a:-a)+",0)"}))):(a=Math.max(0,(n[1]+l[1]-n[0])/2),H.attr("transform",(function(t,e){return"translate(0,"+(1===e?-a:a)+")"})))}}}function _(t){if(k){var e=(t-g[0])%k,a=t-e;return 2*e>k&&(a+=k),t instanceof Date?new Date(a):a}if(A){var n=r.scan(A.map((function(e){return Math.abs(t-e)})));return A[n]}return t}function C(t,e){(d[0]!==t[0]||d.length>1&&d[1]!==t[1])&&(d=t,e&&q.call("onchange",Q,1===t.length?t[0]:t),U())}function G(t,a){z&&((a=void 0!==a&&a)?(z.selectAll(".parameter-value").data(t).transition().ease(s.easeQuadOut).duration(200).attr("transform",(function(t){return B(e(t))})).select(".handle").attr("aria-valuenow",(function(t){return t})),M&&j.transition().ease(s.easeQuadOut).duration(200).attr(O+"1",1===d.length?e.range()[0]-8*P:e(t[0])).attr(O+"2",1===d.length?e(t[0]):e(t[1]))):(z.selectAll(".parameter-value").data(t).attr("transform",(function(t){return B(e(t))})).select(".handle").attr("aria-valuenow",(function(t){return t})),M&&j.attr(O+"1",1===d.length?e.range()[0]-8*P:e(t[0])).attr(O+"2",1===d.length?e(t[0]):e(t[1]))),p&&H.text((function(e,a){return D(t[a])})))}return e&&(g=[r.min(e.domain()),r.max(e.domain())],1===t||3===t?m=r.max(e.range())-r.min(e.range()):h=r.max(e.range())-r.min(e.range()),e=e.clamp(!0)),Q.min=function(t){return arguments.length?(g[0]=t,e&&e.domain(g),Q):g[0]},Q.max=function(t){return arguments.length?(g[1]=t,e&&e.domain(g),Q):g[1]},Q.domain=function(t){return arguments.length?(g=t,e&&e.domain(g),Q):g},Q.width=function(t){return arguments.length?(m=t,e&&e.range([e.range()[0],e.range()[0]+m]),Q):m},Q.height=function(t){return arguments.length?(h=t,e&&e.range([e.range()[0],e.range()[0]+h]),Q):h},Q.tickFormat=function(t){return arguments.length?(w=t,Q):w},Q.displayFormat=function(t){return arguments.length?(D=t,Q):D},Q.ticks=function(t){return arguments.length?(b=t,Q):b},Q.value=function(t){if(!arguments.length)return 1===d.length?d[0]:d;var a=Array.isArray(t)?t:[t];if(a.sort((function(t,e){return t-e})),e){var n=a.map(e).map(F),r=n.map(e.invert).map(_);G(r,!0),C(r,!0)}else d=a;return Q},Q.silentValue=function(t){if(!arguments.length)return 1===d.length?d[0]:d;var a=Array.isArray(t)?t:[t];if(a.sort((function(t,e){return t-e})),e){var n=a.map(e).map(F),r=n.map(e.invert).map(_);G(r,!1),C(r,!1)}else d=a;return Q},Q.default=function(t){if(!arguments.length)return 1===f.length?f[0]:f;var e=Array.isArray(t)?t:[t];return e.sort((function(t,e){return t-e})),f=e,d=e,Q},Q.step=function(t){return arguments.length?(k=t,Q):k},Q.tickValues=function(t){return arguments.length?(x=t,Q):x},Q.tickPadding=function(t){return arguments.length?(y=t,Q):y},Q.marks=function(t){return arguments.length?(A=t,Q):A},Q.handle=function(t){return arguments.length?(v=t,Q):v},Q.displayValue=function(t){return arguments.length?(p=t,Q):p},Q.fill=function(t){return arguments.length?(M=t,Q):M},Q.on=function(){var t=q.on.apply(q,arguments);return t===q?Q:t},Q}t.sliderBottom=function(t){return d(3,t)},t.sliderHorizontal=function(t){return d(3,t)},t.sliderLeft=function(t){return d(4,t)},t.sliderRight=function(t){return d(2,t)},t.sliderTop=function(t){return d(1,t)},t.sliderVertical=function(t){return d(4,t)},Object.defineProperty(t,"__esModule",{value:!0})}));
